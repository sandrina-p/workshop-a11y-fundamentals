<!DOCTYPE html>
<!--
üß© 4.2: More meaningful content
üéØ Goal: Improve the accessibility of each case
-->
<html lang="en">

<head>
  <title>Exercise #4.2</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:400,600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../assets/theme.css">
  <link rel="stylesheet" href="4.2.css">
</head>

<body>
  <script>
    function ignoreIfDisabled(event) {
      const isDisabled = event.target.getAttribute('aria-disabled') === 'true';

      if (isDisabled) {
        event.preventDefault();
        event.target.blur(); // prevent focus on click.
        console.log('disabled - click ignored')
        return true
      }

      return false
    }
  </script>

  <main class="content">
    <h1 class="title-xl">On-demand changes</h1>

    <div class="g-card stgs js-caseToggle" data-sound="off" data-theme="light" data-size="md">

      <div class="part">
        <!-- üí° Check the Accessibiliy tree of this button. The default
          name is "Sound off, not pressed". Does that mean the sound is off or on? 
          How can we make it clear using ARIA and .sr-only?
          P.S. Read "Tips about dynamic names and states" for further hints.
        -->
        <button class="stgs-btnOnOff js-sound" aria-pressed="false">
          <span class="off">
            <span aria-hidden="true">ü§ê</span> Sound off
          </span>
          <span class="on">
            <span aria-hidden="true">üîä</span> Sound on
          </span>
        </button>
      </div>

      <div class="part">
        <!-- üí°
          This visually looks like a checkbox, but what makes an element
          a toggle button vs a checkbox?
          P.S. Read "Tips about moments of action" for further hints.
        -->
        <label class="stgs-toggleTheme">
          <input type="checkbox" id="darkTheme" class="js-theme" />
          <span class="stgs-toggleTheme-fakeCheck"></span>
          Dark theme
        </label>
      </div>

      <div class="part">
        <!-- üí°
          This visually looks like a checkbox, but what makes an element
          a toggle button vs a checkbox?
          P.S. Read "Tips about keyboard navigation" for further hints.
          üé® To solve this, don't worry about styling.
          Focus on the semantics and making sure it works well for keyboard.
        -->
        <fieldset class="stgs-toolbar">
          <span class="stgs-toolbar-title">Text size</span>
          <label>
            <input class="js-size" type="radio" name="size" value="sm" />
            Small
          </label>
          <label>
            <input class="js-size" type="radio" name="size" value="md" checked />
            Medium
          </label>
          <label>
            <input class="js-size" type="radio" name="size" value="lg" />
            Large
          </label>
          <label>
            <input class="js-size" type="radio" name="size" value="pro" disabled />
            Custom (PRO)
          </label>
        </fieldset>
      </div>
    </div>
  </main>

  <script>
    const elCaseToggle = document.getElementsByClassName('js-caseToggle')[0];
    const elSound = document.getElementsByClassName('js-sound')[0];
    const elTheme = document.getElementsByClassName('js-theme')[0];
    const elsSize = document.getElementsByClassName('js-size');

    const audioOn = new Audio('https://freesound.org/data/previews/504/504847_9961300-lq.mp3');
    const audioOff = new Audio('https://freesound.org/data/previews/324/324659_2901073-lq.mp3');

    elSound.addEventListener('click', function () {
      const isPressed = elSound.getAttribute('aria-pressed') === 'true';
      elSound.setAttribute("aria-pressed", !isPressed);

      // üí°üîá You can comment this to disable the sound
      if (!isPressed) {
        audioOn.play();
      } else {
        audioOff.play()
      }
    })

    elTheme.addEventListener('change', function (e) {
      elCaseToggle.setAttribute('data-theme', e.target.checked ? 'dark' : 'light')
    })

    Array.from(elsSize).forEach(el => el.addEventListener('click', function (e) {
      elCaseToggle.setAttribute('data-size', e.target.value)
    }))
  </script>
</body>

</html>